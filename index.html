<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Document Analyzer</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body{font-family:system-ui,Arial;margin:24px;color:#111}
.wrap{max-width:900px;margin:0 auto}
input,textarea,select{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px}
button{padding:10px 16px;border:0;border-radius:8px;cursor:pointer;background:#111;color:#fff}
button.secondary{background:#eee;color:#111}
textarea{font-family:ui-monospace,Consolas}
</style>
</head>
<body>
<div class="wrap">
<h1>Document Analyzer</h1>
<p>Upload a file, select options, and get an instant AI analysis.</p>
<label>Upload file</label>
<input id="file" type="file" />
<label>Instructions (optional)</label>
<textarea id="instruction" rows="4" placeholder="e.g. Summarize, extract key points, etc."></textarea>
<div style="margin:12px 0;">
<button id="analyze">Analyze</button>
<button id="download" class="secondary">Download .txt</button>
<span id="status" style="margin-left:8px;color:#666"></span>
</div>
<textarea id="output" rows="14" placeholder="Result will appear here..."></textarea>
</div>
<script>
const API="/api/analyze";
const $=s=>document.querySelector(s);
$("#analyze").onclick=async()=>{
  const f=$("#file").files[0];if(!f)return $("#output").value="Select a file first.";
  const ins=$("#instruction").value||"Summarize the document.";
  $("#status").textContent="Analyzing...";
  const fd=new FormData();fd.append("file",f);fd.append("instruction",ins);
  try{
    const r=await fetch(API,{method:"POST",body:fd});
    const t=await r.text();let d;try{d=JSON.parse(t);}catch{d={error:t};}
    if(!r.ok)throw new Error(d.error||"Request failed");
    $("#output").value=d.result.trim();$("#status").textContent="Done";
  }catch(e){$("#output").value="Error: "+e.message;$("#status").textContent="Failed";}
};
$("#download").onclick=()=>{
  const b=new Blob([$("#output").value||""],{type:"text/plain"});
  const u=URL.createObjectURL(b);const a=document.createElement("a");
  a.href=u;a.download="analysis.txt";a.click();URL.revokeObjectURL(u);
};
</script>
</body>
</html>
